<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>GuideR√©nov ‚Äî Assistant travaux</title>
  <style>
    :root{--primary:#2563eb;--secondary:#f97316;--dark:#0f172a;--light:#f8fafc;--muted:#64748b;--success:#10b981}
    *{box-sizing:border-box;margin:0;padding:0}
    html,body{height:100%;font-family:Inter, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;background:var(--light);color:var(--dark);-webkit-font-smoothing:antialiased}
    header{background:linear-gradient(135deg,var(--primary),#1e40af);color:#fff;padding:1rem;position:sticky;top:0;z-index:30}
    .wrap{max-width:1200px;margin:0 auto;padding:1rem}
    .top{display:flex;align-items:center;justify-content:space-between;gap:1rem}
    .logo{display:flex;align-items:center;gap:.6rem;font-weight:700;font-size:1.15rem}
    .cta{background:var(--secondary);border:none;color:#fff;padding:.6rem .9rem;border-radius:10px;cursor:pointer}
    main{padding:1rem}
    .hero{background:#fff;border-radius:12px;padding:1.25rem;margin-top:1rem;box-shadow:0 6px 20px rgba(2,6,23,0.06)}
    .hero h1{color:var(--primary);font-size:1.4rem;margin-bottom:.5rem}
    .grid{display:grid;grid-template-columns:repeat(auto-fit, minmax(240px,1fr));gap:1rem;margin-top:1rem}
    .card{background:#fff;padding:1rem;border-radius:10px;box-shadow:0 4px 14px rgba(2,6,23,0.04);cursor:pointer;display:flex;flex-direction:column}
    .card .meta{font-size:.85rem;color:var(--muted);margin-top:.5rem}

    .controls{display:flex;gap:.75rem;margin-top:1rem;flex-wrap:wrap}
    .search{flex:1;min-width:200px}
    input[type=text],select,input[type=number]{width:100%;padding:.6rem;border-radius:8px;border:1px solid #e6edf3}
    .categories{display:flex;gap:.5rem;flex-wrap:wrap}
    .chip{padding:.4rem .6rem;border-radius:999px;background:#fff;border:1px solid #e6edf3;cursor:pointer;font-size:.85rem}

    .projects-grid{margin-top:1rem}
    .modal{position:fixed;inset:0;background:rgba(2,6,23,0.6);display:none;align-items:center;justify-content:center;padding:1rem;z-index:50}
    .modal.active{display:flex}
    .panel{background:#fff;border-radius:12px;max-width:980px;width:100%;max-height:92vh;overflow:auto}
    .panel .head{padding:1rem 1.25rem;border-bottom:1px solid #f1f5f9;display:flex;align-items:center;justify-content:space-between}
    .panel .body{padding:1rem}
    .materials{display:grid;grid-template-columns:1fr 120px;gap:.5rem;margin-top:.75rem}
    .steps{margin-top:1rem}
    .step{background:#fff;border-radius:8px;padding:.8rem;border:1px solid #eef2ff;margin-bottom:.5rem}
    .uploader{border:2px dashed var(--primary);padding:1rem;border-radius:10px;text-align:center;background:#f0f9ff}
    .photo-row{display:flex;gap:.5rem;margin-top:.5rem;flex-wrap:wrap}
    .photo-row img{width:110px;height:80px;object-fit:cover;border-radius:8px;border:2px solid #e6f0ff}
    footer{margin:2rem 0;color:var(--muted);text-align:center}
    @media (max-width:720px){.top{flex-direction:column;align-items:flex-start}}
  </style>
</head>
<body>
  <header>
    <div class="wrap top">
      <div class="logo">üî® GuideR√©nov ‚Äî Assistant travaux</div>
      <div>
        <button class="cta" onclick="scrollTo('#start')">Commencer un projet</button>
      </div>
    </div>
  </header>

  <main class="wrap">
    <section class="hero" id="start">
      <h1>Prends une photo, saisis les cotes. Nous g√©n√©rons la liste mat√©riaux et la notice pas √† pas.</h1>
      <p style="color:var(--muted);margin-top:.5rem">Calculs standards (peinture, parquet, plinthes, √©tag√®res, radiateurs...) et guide outillage adapt√©.</p>

      <div class="controls">
        <div class="search"><input type="text" id="search" placeholder="Rechercher un projet, ex: peinture mur" oninput="renderProjects()"></div>
        <div style="min-width:140px"><select id="categoryFilter" onchange="renderProjects()"><option value="all">Toutes cat√©gories</option></select></div>
        <div style="min-width:160px"><button class="chip" onclick="openNewProject()">Nouveau projet</button></div>
      </div>

      <div style="margin-top:1rem;color:var(--muted);font-size:.9rem">Projets disponibles : <span id="count">0</span></div>
    </section>

    <section class="projects-grid" id="projectsGrid"></section>
  </main>

  <div class="modal" id="modal">
    <div class="panel" role="dialog" aria-modal="true">
      <div class="head">
        <div><strong id="mTitle">Titre</strong><div id="mMeta" style="color:var(--muted);font-size:.85rem"></div></div>
        <div><button onclick="closeModal()" style="border:none;background:transparent;font-size:1.2rem;cursor:pointer">‚úï</button></div>
      </div>
      <div class="body" id="mBody"></div>
    </div>
  </div>

  <footer class="wrap"><small>Prototype ‚Äî GuideR√©nov. Donn√©es exemples. H√©bergement et publication √† pr√©voir.</small></footer>

  <script>
    // --- Data: 73 projets g√©n√©r√©s √† partir d'une liste d'intitul√©s ---
    const rawTitles = [
      // Menuiserie (10)
      'Montage meuble IKEA (Billy, Kallax)', 'Montage placard encastr√©','Pose de parquet flottant','Pose de plinthes','Montage lit/armoire','Installation plan de travail cuisine','Fabrication √©tag√®res sur mesure','Pose de porte int√©rieure','Remplacement charni√®re porte','Montage dressing modulable',
      // Peinture (8)
      'Peinture mur/plafond','Application sous-couche','Peinture boiseries','Peinture radiateur','Pose de toile de verre','Rebouchage et pon√ßage avant peinture','Peinture fa√ßade ext√©rieure','Vernis meuble bois',
      // √âlectricit√© (7)
      'Installation prise murale','Pose plafonnier','Remplacement interrupteur','Installation d√©tecteur de mouvement','Installation applique murale','Pose variateur d\'intensit√©','Tirage simple de c√¢ble',
      // Plomberie (8)
      'Installation lavabo/vasque','Montage robinet/mitigeur','Installation machine √† laver','Pose colonne de douche','Remplacement siphon','Pose √©vacuation lave-vaisselle','Installation ballon d\'eau petit mod√®le','Changement flexible douche',
      // Chauffage (6)
      'Pose radiateur √©lectrique mural','Installation thermostat connect√©','Remplacement radiateur','Pose s√®che-serviette','Installation grille a√©ration','Montage chaudi√®re (guide pro)',
      // S√©curit√© & Serrurerie (6)
      'Remplacement barillet porte','Pose serrure additionnelle','Installation d√©tecteur fum√©e','Pose judas porte','Installation sonnette connect√©e','Pose verrou s√©curit√© fen√™tre',
      // Ma√ßonnerie (6)
      'Scellement cheville chimique','Rebouchage trou & fissure','Pose carrelage mural petit format','Jointoiement carrelage','Cr√©ation coffrage l√©ger','R√©paration pl√¢tre',
      // Am√©nagement (8)
      'Pose tringle √† rideaux','Installation miroir mural','Montage meuble TV','Montage bureau','Installation √©tag√®res murales','Pose store enrouleur','Installation porte coulissante','Montage mezzanine l√©g√®re',
      // Ext√©rieur (6)
      'Montage abri jardin','Pose cl√¥ture simple','Installation luminaire ext√©rieur','Pose goutti√®re PVC','Installation r√©cup√©rateur d\'eau','Am√©nagement bac √† fleurs',
      // Entretien & Divers (10)
      'Remplacement joint silicone salle de bain','Entretien robinetterie','Changement poign√©e fen√™tre','Pose joint anti-courant d\'air','D√©bouchage simple √©vier','Pose bo√Æte aux lettres','Installation d√©tecteur monoxyde de carbone','Petite soudure m√©tal','R√©paration carrosserie ab√Æm√©e','Mise √† niveau sol l√©ger'
    ];

    // categories mapping for display and filter
    const categoryMap = {
      'Menuiserie': ['Montage meuble IKEA (Billy, Kallax)','Montage placard encastr√©','Pose de parquet flottant','Pose de plinthes','Montage lit/armoire','Installation plan de travail cuisine','Fabrication √©tag√®res sur mesure','Pose de porte int√©rieure','Remplacement charni√®re porte','Montage dressing modulable'],
      'Peinture': ['Peinture mur/plafond','Application sous-couche','Peinture boiseries','Peinture radiateur','Pose de toile de verre','Rebouchage et pon√ßage avant peinture','Peinture fa√ßade ext√©rieure','Vernis meuble bois'],
      '√âlectricit√©': ['Installation prise murale','Pose plafonnier','Remplacement interrupteur','Installation d√©tecteur de mouvement','Installation applique murale','Pose variateur d\'intensit√©','Tirage simple de c√¢ble'],
      'Plomberie': ['Installation lavabo/vasque','Montage robinet/mitigeur','Installation machine √† laver','Pose colonne de douche','Remplacement siphon','Pose √©vacuation lave-vaisselle','Installation ballon d\'eau petit mod√®le','Changement flexible douche'],
      'Chauffage': ['Pose radiateur √©lectrique mural','Installation thermostat connect√©','Remplacement radiateur','Pose s√®che-serviette','Installation grille a√©ration','Montage chaudi√®re (guide pro)'],
      'S√©curit√©': ['Remplacement barillet porte','Pose serrure additionnelle','Installation d√©tecteur fum√©e','Pose judas porte','Installation sonnette connect√©e','Pose verrou s√©curit√© fen√™tre'],
      'Ma√ßonnerie': ['Scellement cheville chimique','Rebouchage trou & fissure','Pose carrelage mural petit format','Jointoiement carrelage','Cr√©ation coffrage l√©ger','R√©paration pl√¢tre'],
      'Am√©nagement': ['Pose tringle √† rideaux','Installation miroir mural','Montage meuble TV','Montage bureau','Installation √©tag√®res murales','Pose store enrouleur','Installation porte coulissante','Montage mezzanine l√©g√®re'],
      'Ext√©rieur': ['Montage abri jardin','Pose cl√¥ture simple','Installation luminaire ext√©rieur','Pose goutti√®re PVC','Installation r√©cup√©rateur d\'eau','Am√©nagement bac √† fleurs'],
      'Entretien': ['Remplacement joint silicone salle de bain','Entretien robinetterie','Changement poign√©e fen√™tre','Pose joint anti-courant d\'air','D√©bouchage simple √©vier','Pose bo√Æte aux lettres','Installation d√©tecteur monoxyde de carbone','Petite soudure m√©tal','R√©paration carrosserie ab√Æm√©e','Mise √† niveau sol l√©ger']
    };

    // Build projects array with standardized structure
    const projects = rawTitles.map((t,i)=>{
      // determine category
      let cat = 'Autre';
      for(const k of Object.keys(categoryMap)) if(categoryMap[k].includes(t)){cat=k;break}
      // difficulty heuristic
      const diff = i%3===0? 'easy' : (i%3===1? 'medium':'hard');
      // default materials/tools/steps simplified
      const materials = [{name: 'Main d\'oeuvre / kit de base', quantity: '1', price: 'variable'}];
      const tools = ['M√®tre','Niveau','Perceuse-visseuse'];
      const steps = [
        {title:'Prise de mesures', desc:'Mesurez pr√©cis√©ment la zone concern√©e.'},
        {title:'Pr√©paration', desc:'D√©gagez la zone et prot√©gez les surfaces sensibles.'},
        {title:'Ex√©cution', desc:'Suivez les √©tapes sp√©cifiques au projet.'},
        {title:'Finitions', desc:'Nettoyez et v√©rifiez la qualit√© du travail.'}
      ];
      // custom for quelques types
      const lower = t.toLowerCase();
      // paint specific
      if(lower.includes('peinture')){
        materials.unshift({name:'Peinture (estimation)', quantity:'variable', price:'‚Ç¨/L'});
        tools.unshift('Rouleau','Pinceau','Bac √† peinture');
        steps.unshift({title:'Protection', desc:'Protection du sol et des meubles.'});
      }
      if(lower.includes('parquet')|| lower.includes('plancher')){
        materials.unshift({name:'Lames parquet', quantity:'m¬≤ +10%', price:'‚Ç¨/m¬≤'});
        tools.unshift('Scie','Cale de frappe');
      }
      if(lower.includes('radiateur')||lower.includes('chauffage')){
        materials.unshift({name:'Radiateur (r√©f√©rence √† v√©rifier)', quantity:'1', price:'‚Ç¨'});
        tools.unshift('Cl√© √† molette');
      }
      if(lower.includes('√©tag√®re')||lower.includes('tringle')){
        materials.unshift({name:'√âtag√®re / tringle', quantity:'1', price:'‚Ç¨'});
        tools.unshift('Perceuse','Chevilles');
      }

      // calcFormula standard templates
      const calcFormula = (dimensions)=>{
        // dimensions: {height, width, depth} in cm
        const h = Number(dimensions.height)||0;
        const w = Number(dimensions.width)||0;
        const d = Number(dimensions.depth)||0;
        const area = Math.round((h/100)*(w/100)*100)/100; // m2
        let result = {items:[], estimateEuro: 'variable'};
        if(lower.includes('peinture')){
          const sqm = area>0? area : 10; // fallback
          const liters = Math.max(1, Math.ceil((sqm/10))); // 10m2 per L as base
          const price = liters*15; result.items.push({name:'Peinture (L)', qty:liters, unit:'L'}); result.estimateEuro = price + ' ‚Ç¨ (est.)';
          result.notes = `Surface estim√©e ${sqm} m¬≤. Pr√©voir sous-couche si n√©cessaire.`;
        } else if(lower.includes('parquet')){
          const sqm = area>0? area : 10; const qty = Math.ceil(sqm*1.1); result.items.push({name:'Lames parquet (m¬≤)', qty, unit:'m¬≤'}); result.estimateEuro = Math.round(qty*25) + ' ‚Ç¨ (est.)';
        } else if(lower.includes('plinthe')){
          const perim = h>0 && w>0? 2*((h/100)+(w/100)) : 10; const ml = Math.ceil(perim); result.items.push({name:'Plinthes (ml)', qty:ml, unit:'ml'}); result.estimateEuro = Math.round(ml*8) + ' ‚Ç¨ (est.)';
        } else {
          // generic: list basic kit
          result.items.push({name:'Kit outils de base', qty:1, unit:'kit'});
          result.estimateEuro = 'variable';
        }
        return result;
      };

      return {id:i+1,title:t,category:cat,difficulty:diff,time:'variable',description:'Fiche pas-√†-pas pour '+t,materials,tools,steps,calcFormula}
    });

    // --- UI: populate categories filter ---
    const categories = ['Toutes cat√©gories',...Object.keys(categoryMap)];
    const catSelect = document.getElementById('categoryFilter');
    categories.forEach(c=>{ const opt=document.createElement('option'); opt.value=c; opt.textContent=c; catSelect.appendChild(opt)});

    // render projects
    function renderProjects(){
      const q = document.getElementById('search').value.toLowerCase();
      const cf = document.getElementById('categoryFilter').value;
      const grid = document.getElementById('projectsGrid'); grid.innerHTML='';
      const filtered = projects.filter(p=>{
        if(cf!=='Toutes cat√©gories' && p.category!==cf) return false;
        if(q && !(p.title.toLowerCase().includes(q) || p.description.toLowerCase().includes(q))) return false;
        return true;
      });
      document.getElementById('count').textContent = filtered.length;
      filtered.forEach(p=>{
        const el = document.createElement('div'); el.className='card';
        el.innerHTML = `<div style="font-weight:700">${escapeHtml(p.title)}</div>
                        <div class="meta">${p.category} ‚Ä¢ ${p.difficulty}</div>
                        <div style="margin-top:.6rem;color:var(--muted);font-size:.95rem">${escapeHtml(p.description)}</div>`;
        el.onclick = ()=> openProject(p);
        grid.appendChild(el);
      });
    }

    // helpers
    function escapeHtml(s){return String(s).replace(/[&<>"']/g,function(c){return{'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":"&#39;"}[c]})}

    // open project modal with interactive calculator
    function openProject(p){
      const m = document.getElementById('modal'); m.classList.add('active');
      document.getElementById('mTitle').textContent = p.title;
      document.getElementById('mMeta').textContent = `${p.category} ‚Ä¢ ${p.difficulty}`;
      const body = document.getElementById('mBody'); body.innerHTML = '';

      // photo uploader
      const up = document.createElement('div'); up.className='uploader'; up.innerHTML = `<div>üì∑ Charger une photo (optionnel)</div><input type="file" id="photoInput" accept="image/*"> <div class="photo-row" id="photoRow"></div>`;
      body.appendChild(up);
      up.querySelector('#photoInput').addEventListener('change',ev=>{
        const row = up.querySelector('#photoRow'); row.innerHTML=''; Array.from(ev.target.files).forEach(f=>{ const url = URL.createObjectURL(f); const img = document.createElement('img'); img.src=url; row.appendChild(img)});
      });

      // dimensions form
      const form = document.createElement('div'); form.style.marginTop='1rem';
      form.innerHTML = `<div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(120px,1fr));gap:.5rem">
        <div><label>Hauteur (cm)</label><input type="number" id="dimH" placeholder="ex: 250"></div>
        <div><label>Largeur (cm)</label><input type="number" id="dimW" placeholder="ex: 400"></div>
        <div><label>Profondeur (cm)</label><input type="number" id="dimD" placeholder="ex: 30"></div>
      </div>
      <div style="margin-top:.6rem"><button class="cta" id="calcBtn">Calculer besoins & prix</button></div>
      `;
      body.appendChild(form);

      // materials and steps container
      const out = document.createElement('div'); out.id='calcOut'; body.appendChild(out);

      // tools and steps quick view
      const tools = document.createElement('div'); tools.style.marginTop='1rem'; tools.innerHTML = `<strong>Outillage recommand√©</strong><div style="color:var(--muted);margin-top:.4rem">${p.tools.join(', ')}</div>`;
      body.appendChild(tools);

      const steps = document.createElement('div'); steps.className='steps'; steps.innerHTML = `<strong>√âtapes</strong>`;
      p.steps.forEach(s=>{ const el = document.createElement('div'); el.className='step'; el.innerHTML = `<div style="font-weight:700">${escapeHtml(s.title)}</div><div style="color:var(--muted);margin-top:.3rem">${escapeHtml(s.desc)}</div>`; steps.appendChild(el)});
      body.appendChild(steps);

      // attach calc
      form.querySelector('#calcBtn').onclick = ()=>{
        const h = form.querySelector('#dimH').value; const w = form.querySelector('#dimW').value; const d = form.querySelector('#dimD').value;
        const res = p.calcFormula({height:h,width:w,depth:d});
        renderCalc(res, out);
      }
    }

    function renderCalc(res, out){
      out.innerHTML = `<div style="margin-top:1rem;background:linear-gradient(135deg,#f8fafc,#eef6ff);padding:1rem;border-radius:8px"><strong>Liste mat√©riaux estim√©e</strong>`;
      const list = document.createElement('div'); list.style.marginTop='.6rem';
      (res.items||[]).forEach(it=>{ const row = document.createElement('div'); row.style.display='flex'; row.style.justifyContent='space-between'; row.style.padding='.5rem 0'; row.innerHTML = `<div>${escapeHtml(it.name)}</div><div style="font-weight:700">${it.qty} ${it.unit||''}</div>`; list.appendChild(row)});
      out.appendChild(list);
      if(res.estimateEuro) out.innerHTML += `<div style="margin-top:.8rem;font-weight:700;color:var(--success)">${res.estimateEuro}</div>`;
      if(res.notes) out.innerHTML += `<div style="margin-top:.6rem;color:var(--muted)">${escapeHtml(res.notes)}</div>`;
      out.innerHTML += `</div>`;
    }

    function closeModal(){ document.getElementById('modal').classList.remove('active') }

    function openNewProject(){
      // open a generic project creation modal that uses search to pick template
      const p = {title:'Nouveau projet',category:'Personnalis√©',difficulty:'custom',description:'Cr√©ez votre projet'}; openProject(p);
    }

    function scrollTo(sel){ document.querySelector(sel).scrollIntoView({behavior:'smooth'}) }

    // initial render
    renderProjects();

    // expose for debugging
    window.renderProjects = renderProjects; window.openProject = openProject; window.closeModal = closeModal; window.openNewProject = openNewProject;

  </script>
</body>
</html>
